var M=require("axios"),V=require("cheerio");module.exports={platform:"mvmp3",version:"0.0.8",author:"公众号:非主流的小城生活",srcUrl:"https://ghproxy.net/https:/raw.githubusercontent.com/lushunming/MyMusicFree/master/dist/mvmp3.js",cacheControl:"no-store",async search(B,v,z){if(z==="music"){let F=(await M.get("https://www.mvmp3.com/so.php?wd="+encodeURI(B)+"&page="+v)).data,b=V.load(F),A=[];return b("div.play_list ul li ").each((D,C)=>{let G=b(C).find("div.pic a").attr("href"),j=b(C).find("div.name").text().trim(),K=b(C).find("div.name").text().trim(),T=b(C).find("img").attr("src"),U="";A.push({id:G,title:j,artist:K,artwork:T,album:""})}),{isEnd:!0,data:A}}},async getMusicInfo(B){let v=B.id+"";v=v.replace("/mp3/","").replace(".html","");let z=(await M.post("https://www.mvmp3.com/style/js/play.php",{id:v,type:"dance"},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})).data;return{url:z.url,rawLrc:z.lrc,title:z.name}},async getMediaSource(B,v){let z=B.id+"";return z=z.replace("/mp3/","").replace(".html",""),{url:(await M.post("https://www.mvmp3.com/style/js/play.php",{id:z,type:"dance"},{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}})).data.url}},async getTopLists(){let B=(await M.get("https://www.mvmp3.com/list/kugou.html")).data,v=V.load(B),z=[];return v("div.class").each((b,A)=>{let Q=v(A).find("h1").text(),D=[];v(A).find("a").each((C,G)=>{let j=v(G).attr("href"),K=v(G).text();D.push({id:j,title:K})}),z.push({title:Q,data:D})}),z},async getTopListDetail(B,v){let z=B.id.replaceAll(".html",""),F=(await M.get("https://www.mvmp3.com"+z+"/"+v+".html")).data,b=V.load(F),A=[];b("div.play_list ul li ").each((G,j)=>{let K=b(j).find("div.pic a").attr("href"),T=b(j).find("div.name").text().trim(),U=b(j).find("div.name").text().trim(),W=b(j).find("img").attr("src"),X="";A.push({id:K,title:T,artist:U,artwork:W,album:""})});let D=b("div.page a"),C=!0;return D.each((G,j)=>{if(b(j).text()==="下一页")C=!1}),{isEnd:C,musicList:A}},async getRecommendSheetTags(){let B=(await M.get("https://www.mvmp3.com/gdlist/index.html")).data,v=V.load(B),z=[];return v("div.class ul li a").each((b,A)=>{let Q=v(A).attr("href"),D=v(A).text();z.push({id:Q,title:D})}),{data:z,pinned:z}},async getRecommendSheetsByTag(B,v){let z=B.id?B.id.replaceAll(".html",""):"/gdlist/index.html".replaceAll(".html",""),F=(await M.get("https://www.mvmp3.com"+z+"/"+v+".html")).data,b=V.load(F),A=[];b("div.lkpic_list ul li ").each((G,j)=>{let K=b(j).find("div.pic a").attr("href"),T=b(j).find("div.name").text().trim(),U=b(j).find("div.name").text().trim(),W=b(j).find("img").attr("src"),X="";A.push({id:K,title:T,artist:U,artwork:W,album:""})});let D=b("div.page a"),C=!0;return D.each((G,j)=>{if(b(j).text()==="下一页")C=!1}),{isEnd:C,data:A}},async getMusicSheetInfo(B,v){let z=B.id.replaceAll(".html",""),F=(await M.get("https://www.mvmp3.com"+z+"/"+v+".html")).data,b=V.load(F),A=[];b("div.play_list ul li ").each((G,j)=>{let K=b(j).find("div.pic a").attr("href"),T=b(j).find("div.name").text().trim(),U=b(j).find("div.name").text().trim(),W=b(j).find("img").attr("src"),X="";A.push({id:K,title:T,artist:U,artwork:W,album:""})});let D=b("div.page a"),C=!0;return D.each((G,j)=>{if(b(j).text()==="下一页")C=!1}),{isEnd:C,musicList:A}}};
